# RuleReady Compliance

A comprehensive AI-powered compliance management system for employment law. Built with Next.js, Convex, Firecrawl, and Google Gemini.

## üéØ Overview

RuleReady helps businesses navigate complex employment law compliance requirements across federal, state, and local jurisdictions. The platform combines AI-powered chat, web research capabilities, and structured templates to deliver actionable compliance guidance.

## ‚ú® Features

### ü§ñ AI Chat Assistant
- Ask questions about employment law in natural language
- Powered by Google Gemini 2.0 Flash
- Filter by jurisdiction and topic for focused answers
- Configurable system prompts and model settings
- Real-time responses with structured formatting

### üî¨ Compliance Research
- Deep research mode combining multiple data sources:
  - Web search results (Firecrawl Search API)
  - User-provided URL scraping (supports PDFs)
  - News articles integration
- AI synthesizes comprehensive answers from all sources
- Template-driven structured output
- Save research results for later reference
- Proper attribution with clickable source links

### üìö Saved Research
- View and manage saved research results
- Search across all saved content
- Filter by jurisdiction, topic, and template
- Edit research content with TipTap rich text editor
- Edit research metadata (title, jurisdiction, topic)
- Create new research entries manually
- Colorful topic breakdown in side panel

### üìã Template Management
- **Topic-specific templates** created by legal compliance experts
- **1 general template** for cross-cutting issues
- Each template includes:
  - Quick Overview
  - Covered Employers/Employees
  - Detailed Requirements
  - Action Steps
  - Common Violations
  - Penalties
  - Best Practices
  - Recordkeeping
  - Sources
- Multiple templates per topic supported
- Beautiful Tiptap editor for rich text editing
- Topic association with visual badges
- Searchable dropdown grouped by topic
- Full CRUD (Create, Read, Update, Delete, Activate/Deactivate)

### üèõÔ∏è Jurisdictions Management
- Federal, State, and City level coverage
- All 50 US states + DC
- Hierarchical organization (Federal ‚Üí States ‚Üí Cities)
- Active/Inactive status management
- Cascading inactive logic (inactive states hide their cities)
- Employment law coverage flags

### üè∑Ô∏è Topics Management (Complete Redesign)
- Employment law topics across categories:
  - **Wages & Hours** 
  - **Leave & Benefits** 
  - **Safety & Training**
  - **Employment Practices**
  - **Emerging Issues**
  - **Regulatory Compliance**
- Category management (Rename, Merge, Create)
- Searchable dropdown with category grouping
- Active/Inactive status with visual indicators


### Reusable Components
- **JurisdictionSelect** - Searchable jurisdiction dropdown with hierarchy
- **TopicSelect** - Searchable topic dropdown grouped by category
- **TemplateSelect** - Searchable template dropdown grouped by topic
- **TiptapEditorModal** - Rich text editor with markdown conversion
- **ComplianceTemplateEditor** - Full template editing with Tiptap integration

### Color Themes
- **Chat**: Default purple
- **Research**: Purple accents
- **Templates**: Amber/orange theme
- **Jurisdictions**: Blue theme
- **Topics**: Purple theme

## üóÑÔ∏è Database Schema

### Core Tables

#### `complianceTopics`
```typescript
{
  name: string          // "Minimum Wage"
  slug: string          // "minimum-wage" (auto-generated)
  category: string      // "Wages & Hours"
  description: string
  isActive: boolean
  createdAt: number
  updatedAt: number
}
```

#### `complianceTemplates`
```typescript
{
  templateId: string
  title: string
  description?: string
  markdownContent: string    // Full template content
  topicSlug?: string         // Optional topic association
  isActive: boolean
  createdAt: number
  updatedAt: number
}
```

#### `complianceRules`
```typescript
{
  ruleId: string
  jurisdiction: string
  topicSlug: string         // Links to complianceTopics
  topicName: string
  sourceUrl: string
  priority: "critical" | "high" | "medium" | "low"
  monitoringStatus: "active" | "paused" | "error"
  metadata: { ... }
  createdAt: number
  updatedAt: number
}
```

#### `complianceEmbeddings`
```typescript
{
  entityId: string
  entityType: "rule" | "report"
  content: string
  embedding: number[]       // 1536-dimensional vector
  metadata: {
    jurisdiction?: string
    topicSlug?: string     
    contentLength?: number
  }
  createdAt: number
  updatedAt: number
}
```

#### `jurisdictions`
```typescript
{
  code: string              // "US", "CA", "CA-SF"
  name: string              // "Federal", "California", "San Francisco"
  level: "federal" | "state" | "city"
  parentCode?: string       // Hierarchical relationship
  stateCode?: string        // For cities
  displayName?: string      // "San Francisco, CA"
  isActive: boolean
  hasEmploymentLaws: boolean
  lastUpdated: number
}
```

## üöÄ Quick Start

### Prerequisites
- Node.js 18+ and npm
- [Convex](https://convex.dev) account 
- [Firecrawl](https://firecrawl.dev) API key
- [Google AI Studio](https://aistudio.google.com) API key

### Installation

```bash
# Clone repository
git clone https://github.com/willysharp5/RuleReady_.git
cd RuleReady_

# Install dependencies
npm install

# Initialize Convex (opens browser for authentication)
npx convex dev
```

### Environment Setup

```bash
# Set API keys in Convex
npx convex env set FIRECRAWL_API_KEY "your_firecrawl_api_key"
npx convex env set GEMINI_API_KEY "your_gemini_api_key"

# Seed initial data
npx convex run complianceQueries:seedTopics          # 25 topics
npx convex run seedAllTemplates:seedAllComplianceTemplates  # 26 templates
```

### Run Development Server

```bash
# Terminal 1: Convex backend (keep running)
npx convex dev

# Terminal 2: Next.js frontend
npm run dev
```

Visit [http://localhost:3000](http://localhost:3000)

**Default Password:** `gusto`

## üìö Usage Guide

### Managing Topics

**Topics Tab Features:**
- **Add Topic**: Create new compliance topics
- **Edit Topic**: Update name, category, description
- **Activate/Deactivate**: Soft delete without removing
- **Delete**: Remove topics (validates no dependencies)
- **Filter**: By category and active status
- **Search**: Across name, slug, category, description

**Category Management:**
- **Rename**: Update category name across all topics
- **Merge**: Consolidate categories
- **Create**: Add new category with first topic
- Auto-removal when category becomes empty

### Managing Templates

**Templates Tab Features:**
- **Comprehensive Templates** (topic-specific + 1 general)
- **Add Template**: Rich text editor with Tiptap
- **Edit Template**: Full markdown editing with toolbar
- **Associate to Topic**: Link templates to specific topics (multiple allowed)
- **Activate/Deactivate**: Control template availability
- **Delete**: Remove any template
- **Filter**: By topic and active status
- **Search**: Across title, description, topic

**Template Benefits:**
- Multiple templates per topic (Basic, Advanced, Industry-specific)
- General template for cross-cutting issues
- AI structures responses using template format
- Professionally crafted by legal compliance perspective

### Managing Jurisdictions

**Jurisdictions Tab Features:**
- **Add Jurisdiction**: Federal, State, or City
- **Edit**: Update details and settings
- **Delete**: Remove jurisdictions
- **Active/Inactive**: Control visibility
- **Cascading Logic**: Inactive states hide their cities
- **Has Laws**: Flag jurisdictions with employment regulations
- **Filter**: By level, status, and law coverage

### Using AI Chat

1. Select filters (optional):
   - **Jurisdiction**: Focus on specific location
   - **Topic**: Focus on specific compliance area
2. Ask questions in natural language
3. Get answers with:
   - Source citations [1], [2], [3]
   - Jurisdiction and topic badges
   - Similarity scores
   - Clickable source URLs

### Using Research

1. Enter research question
2. Select filters (all optional):
   - **Template**: Structure output format
   - **Jurisdiction**: Geographic focus
   - **Topic**: Subject matter focus
   - **URLs**: Additional sources to scrape
   - **Context**: Extra instructions for AI
3. Get comprehensive research with all sources cited

## üõ†Ô∏è Advanced Features

### Tiptap Rich Text Editor
- **Full WYSIWYG editing** for template content
- **Toolbar**: Bold, Italic, Headings, Lists, Links, Code
- **Smart Link Editing**:
  - Click link ‚Üí Popup with Open/Edit/Delete options
  - Inline editing without separate dialog
  - Update button changes from Edit ‚Üí Update
- **Markdown conversion**: Auto-converts to/from markdown
- **Copy functions**: Copy for Docs, Copy Markdown
- **Undo/Redo**: Full history with proper configuration

### Interactive Dropdowns
All selector components feature:
- **Search functionality**: Find items quickly
- **Hierarchical grouping**: Organized by category/topic
- **Visual indicators**: Active/Inactive badges
- **Clear buttons**: Easy to reset selection
- **Keyboard navigation**: Enter, Escape support
- **Auto-close**: Click outside to dismiss

### Filtering System
Consistent across all tabs:
- **Topic filter**: Beautiful TopicSelect component
- **Status filter**: Active/Inactive dropdown
- **Additional filters**: Tab-specific (level, has laws, default, etc.)
- **Clear Filters button**: Reset all filters at once
- **Pagination reset**: Filters automatically reset to page 1


## üîß Technical Architecture

### Frontend Stack
- **Next.js 15**: React framework with App Router
- **TypeScript**: Type safety throughout
- **TailwindCSS**: Utility-first styling
- **shadcn/ui**: Component library
- **Tiptap**: Rich text editing
- **Lucide Icons**: Modern icon system

### Backend Stack
- **Convex**: Serverless functions + real-time database
- **Semantic Search**: Cosine similarity on embeddings
- **RAG System**: Retrieval-augmented generation
- **Firecrawl**: Web scraping and search
- **Gemini 2.0 Flash**: AI model for chat and research


## üìñ Template Topics Covered

### Wages & Hours
1. Minimum Wage Compliance
2. Overtime & Hours
3. Meal & Rest Breaks
4. Final Pay / Vacation Payout
5. Pay Frequency & Payday Timing
6. Tip Credit / Tipped Employees

### Leave & Benefits
7. Paid Sick Leave
8. Paid Family / Medical Leave (PFML)
9. Jury Duty Leave
10. Voting Leave

### Safety & Training
11. Harassment Training
12. Workers' Compensation
13. Drug Testing

### Employment Practices
14. Posting Requirements
15. Child Labor
16. Background Checks
17. E-Verify
18. Independent Contractor Classification
19. Apprenticeship Programs

### Emerging Issues
20. Pregnancy / Disability / ADA Accommodations
21. Predictive Scheduling
22. Pay Equity / Salary History Bans

### Regulatory Compliance
23. Prevailing Wage Laws
24. Record Retention
25. Unemployment Insurance

### General
26. General Employment Law Compliance (catch-all)

## üéì Template Quality

Each template provides:
- ‚úÖ **Legal precision**: Attorney-level compliance guidance
- ‚úÖ **Actionable**: Step-by-step employer obligations
- ‚úÖ **Comprehensive**: Federal, state, and local requirements
- ‚úÖ **Current**: References to recent laws and guidance
- ‚úÖ **Multi-jurisdictional**: Covers state variations
- ‚úÖ **Practical**: Common violations and best practices
- ‚úÖ **Complete**: Penalties, recordkeeping, sources

## üîê Security & Access

- Simple password authentication (default: `gusto`)
- API keys securely stored in Convex environment
- No user accounts or personal data collection
- All data stored in Convex secure database

## üìÅ Project Structure

```
RuleReady_/
‚îú‚îÄ‚îÄ convex/                          # Backend (Convex)
‚îÇ   ‚îú‚îÄ‚îÄ schema.ts                    # Database schema
‚îÇ   ‚îú‚îÄ‚îÄ complianceTopics.ts          # Topics CRUD & category management
‚îÇ   ‚îú‚îÄ‚îÄ complianceTemplates.ts       # Templates CRUD
‚îÇ   ‚îú‚îÄ‚îÄ complianceQueries.ts         # Jurisdictions & data queries
‚îÇ   ‚îú‚îÄ‚îÄ complianceRAG.ts             # RAG & semantic search
‚îÇ   ‚îú‚îÄ‚îÄ embeddingManager.ts          # Embedding operations
‚îÇ   ‚îú‚îÄ‚îÄ generateEmbeddings.ts        # Embedding generation
‚îÇ   ‚îú‚îÄ‚îÄ seedAllTemplates.ts          # 25 comprehensive templates
‚îÇ   ‚îú‚îÄ‚îÄ chatSettings.ts              # Chat configuration
‚îÇ   ‚îú‚îÄ‚îÄ researchSettings.ts          # Research configuration
‚îÇ   ‚îî‚îÄ‚îÄ savedResearch.ts             # Research library
‚îÇ
‚îú‚îÄ‚îÄ src/
‚îÇ   ‚îú‚îÄ‚îÄ app/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ page.tsx                 # Password protection
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ home/                    # Main application
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ HomePage.tsx         # Tab navigation
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ page.tsx
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ api/
‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ compliance-chat/     # Chat API route
‚îÇ   ‚îÇ       ‚îî‚îÄ‚îÄ compliance-research/ # Research API route
‚îÇ   ‚îÇ
‚îÇ   ‚îú‚îÄ‚îÄ components/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ features/                # Main feature tabs
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ ChatFeature.tsx
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ ResearchFeature.tsx
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ TemplatesFeature.tsx     # Complete redesign
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ JurisdictionsFeature.tsx # Enhanced
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ TopicsFeature.tsx        # Complete redesign
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ AIModelsFeature.tsx
‚îÇ   ‚îÇ   ‚îÇ
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ home/                    # Properties panels (right sidebar)
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ LeftNavigation.tsx
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ RightPropertiesPanel.tsx
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ ChatProperties.tsx
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ ResearchProperties.tsx   # Enhanced with TemplateSelect
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ TemplatesProperties.tsx  # New comprehensive panel
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ JurisdictionsProperties.tsx  # Enhanced stats
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ TopicsProperties.tsx     # New comprehensive panel
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ AccordionSection.tsx
‚îÇ   ‚îÇ   ‚îÇ
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ ui/                      # Reusable UI components
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ jurisdiction-select.tsx  # NEW - Searchable dropdown
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ topic-select.tsx         # NEW - Searchable dropdown
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ template-select.tsx      # NEW - Searchable dropdown
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ button.tsx
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ input.tsx
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ dialog.tsx
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ ... (other shadcn components)
‚îÇ   ‚îÇ   ‚îÇ
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ ComplianceTemplateEditor.tsx # Redesigned with Tiptap
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ TiptapEditorModal.tsx        # Rich text editor
‚îÇ   ‚îÇ
‚îÇ   ‚îî‚îÄ‚îÄ lib/
‚îÇ       ‚îî‚îÄ‚îÄ utils.ts
‚îÇ
‚îú‚îÄ‚îÄ data/                            # Pre-processed compliance data
‚îú‚îÄ‚îÄ docs/                            # Documentation
‚îî‚îÄ‚îÄ scripts/                         # Utility scripts
```



## üôè Credits

Built with:
- [Next.js](https://nextjs.org) - React framework
- [Convex](https://convex.dev) - Backend platform  
- [Firecrawl](https://firecrawl.dev) - Web scraping
- [Google Gemini](https://ai.google.dev) - AI capabilities
- [shadcn/ui](https://ui.shadcn.com) - UI components
- [Tiptap](https://tiptap.dev) - Rich text editor
- [TailwindCSS](https://tailwindcss.com) - Styling
- [Lucide Icons](https://lucide.dev) - Icon system


---

**Version**: 2.0.0  
**Last Updated**: October 2025  
**Status**: Production Ready ‚úÖ
